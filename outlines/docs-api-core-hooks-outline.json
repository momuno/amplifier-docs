{
  "_meta": {
    "name": "hooks-api-outline",
    "description": "API reference documentation for HookRegistry and HookResult in the Amplifier hooks system",
    "use_case": "Reference documentation for developers using the hooks API to register handlers and return results",
    "quadrant": "reference",
    "estimated_lines": "200-300 lines",
    "generation_method": "forward",
    "doc_type": "api_reference",
    "user_intent": "Provide concise API reference for HookRegistry methods and HookResult structure with usage examples"
  },
  "document": {
    "title": "Hooks API",
    "output": "api-core-hooks.md",
    "sections": [
      {
        "heading": "# Hooks API",
        "level": 1,
        "prompt": "Introduce the Hooks API, explaining that hooks provide observability, control, and context injection capabilities. Mention the source file amplifier_core/hooks.py.",
        "sources": [
          {
            "file": "amplifier-core/docs/HOOKS_API.md",
            "reasoning": "Lines 17-29 contain the overview section that introduces hooks and lists the key capabilities (observe, block, modify, inject context, request approval, control output)"
          },
          {
            "file": "amplifier-core/amplifier_core/hooks.py",
            "reasoning": "Lines 1-3 provide the module docstring explaining the hook system provides lifecycle events with deterministic execution"
          }
        ],
        "sections": [
          {
            "heading": "## HookRegistry",
            "level": 2,
            "prompt": "Introduce HookRegistry as the class that manages hook registration and event emission.",
            "sources": [
              {
                "file": "amplifier-core/amplifier_core/hooks.py",
                "reasoning": "Lines 32-36 define the HookRegistry class with docstring explaining it manages lifecycle hooks with deterministic execution"
              }
            ],
            "sections": [
              {
                "heading": "### Methods",
                "level": 3,
                "prompt": "Introduce the methods section for HookRegistry, noting that it provides register() and emit() methods for hook management.",
                "sources": [
                  {
                    "file": "amplifier-core/amplifier_core/hooks.py",
                    "reasoning": "Lines 64-96 and 111-186 contain the register() and emit() method implementations"
                  }
                ],
                "sections": [
                  {
                    "heading": "#### `register(event, handler)`",
                    "level": 4,
                    "prompt": "Document the register() method for registering a handler for an event. Show a code example of defining an async handler function and registering it with coordinator.hooks.register(). Explain the parameters: event (event name to hook into) and handler (async function).",
                    "sources": [
                      {
                        "file": "amplifier-core/amplifier_core/hooks.py",
                        "reasoning": "Lines 64-96 contain the register() method implementation with docstring explaining parameters (event, handler, priority, name) and return value (unregister function)"
                      },
                      {
                        "file": "amplifier-core/docs/HOOKS_API.md",
                        "reasoning": "Lines 97-159 contain the registration section with function signature, parameter documentation, and comprehensive example showing handler definition and registration"
                      }
                    ],
                    "sections": []
                  },
                  {
                    "heading": "#### `emit(event, data) -> list[HookResult]`",
                    "level": 4,
                    "prompt": "Document the emit() method for emitting an event to all registered handlers. Show a code example of calling coordinator.hooks.emit() with event name and data dictionary. Explain it returns a list of HookResult objects.",
                    "sources": [
                      {
                        "file": "amplifier-core/amplifier_core/hooks.py",
                        "reasoning": "Lines 111-186 contain the emit() method with comprehensive docstring explaining sequential execution by priority, short-circuit on deny, data modification chaining, and inject_context merging"
                      }
                    ],
                    "sections": []
                  }
                ]
              }
            ]
          },
          {
            "heading": "## HookResult",
            "level": 2,
            "prompt": "Introduce HookResult as the data structure returned by hook handlers to control execution flow. Mention it's defined in amplifier_core/models.py.",
            "sources": [
              {
                "file": "amplifier-core/docs/HOOKS_API.md",
                "reasoning": "Lines 37-41 introduce HookResult and its purpose for controlling execution flow"
              }
            ],
            "sections": [
              {
                "heading": "### Actions",
                "level": 3,
                "prompt": "Document the available actions in HookResult. Present as a table with Action and Description columns covering: continue (continue execution/default), deny (block the operation), modify (modify the event data), inject_context (inject message into agent context), and ask_user (request user approval).",
                "sources": [
                  {
                    "file": "amplifier-core/docs/HOOKS_API.md",
                    "reasoning": "Lines 81-91 contain the actions table with all five action types, their behaviors, and use cases"
                  }
                ],
                "sections": []
              },
              {
                "heading": "### Fields",
                "level": 3,
                "prompt": "Show the HookResult dataclass definition as a code block with all fields including: action, reason, data, context_injection, context_injection_role, approval_prompt, approval_options, approval_timeout, approval_default, suppress_output, user_message, and user_message_level. Include default values and types.",
                "sources": [
                  {
                    "file": "amplifier-core/docs/HOOKS_API.md",
                    "reasoning": "Lines 45-79 contain the complete HookResult class definition with proper type annotations for all fields organized by purpose"
                  }
                ],
                "sections": []
              },
              {
                "heading": "### Examples",
                "level": 3,
                "prompt": "Introduce the examples section showing common HookResult usage patterns.",
                "sources": [
                  {
                    "file": "amplifier-core/docs/HOOKS_API.md",
                    "reasoning": "Lines 208-358 contain multiple pattern examples demonstrating HookResult usage"
                  }
                ],
                "sections": [
                  {
                    "heading": "#### Continue (observe only)",
                    "level": 4,
                    "prompt": "Show a simple example of returning HookResult(action='continue') for observation-only hooks.",
                    "sources": [
                      {
                        "file": "amplifier-core/docs/HOOKS_API.md",
                        "reasoning": "Lines 210-238 contain examples of continue action in context of validation hooks"
                      }
                    ],
                    "sections": []
                  },
                  {
                    "heading": "#### Deny operation",
                    "level": 4,
                    "prompt": "Show an example of returning HookResult(action='deny', reason='Blocked by policy') to block an operation.",
                    "sources": [
                      {
                        "file": "amplifier-core/docs/HOOKS_API.md",
                        "reasoning": "The deny action is documented in the actions table and used in pattern examples for blocking operations"
                      }
                    ],
                    "sections": []
                  },
                  {
                    "heading": "#### Inject context to agent",
                    "level": 4,
                    "prompt": "Show an example of returning HookResult(action='inject_context', context_injection='...', user_message='...') to inject feedback into the agent's context.",
                    "sources": [
                      {
                        "file": "amplifier-core/docs/HOOKS_API.md",
                        "reasoning": "Lines 210-238 provide the context injection pattern with a complete validation hook example showing inject_context action, context_injection field, and user_message"
                      }
                    ],
                    "sections": []
                  },
                  {
                    "heading": "#### Request approval",
                    "level": 4,
                    "prompt": "Show an example of returning HookResult(action='ask_user', approval_prompt='...', approval_default='deny') to request user approval for an operation.",
                    "sources": [
                      {
                        "file": "amplifier-core/docs/HOOKS_API.md",
                        "reasoning": "Lines 240-266 provide the approval gates pattern with a production protection example showing ask_user action, approval_prompt, approval_options, timeout, and default"
                      }
                    ],
                    "sections": []
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}
